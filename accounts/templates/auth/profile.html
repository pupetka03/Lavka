{% extends "main.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="main-content">
    <div id="feed1" class="feed-content active">
        <div class="bg-gray-50 min-h-screen">
            <div class="max-w-2xl mx-auto p-4">
                <!-- –®–∞–ø–∫–∞ –ø—Ä–æ—Ñ—ñ–ª—é -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-4">
                    <div class="text-center">
                        <div class="user-badge">
                            {{ profile_user.username|first|upper }}
                        </div>
                        <h1 class="text-2xl font-bold text-gray-900">{{ profile_user.username }}</h1>
                        <p class="text-gray-600">@{{ profile_user.username }}</p>
                        
                        <div class="flex justify-center gap-6 mt-4">
                            <div class="text-center">
                                <div class="stat-number">{{ user_posts_count }}</div>
                                <div class="stat-label">Publik√°ci√≠</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="stat-number">{{ user_likes_count }}</div>
                                <div class="stat-label">P√°ƒçi sa</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="stat-number">{{ user_comments_count }}</div>
                                <div class="stat-label">Koment√°re</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <a href="{% url 'home_page' %}" class="inline-block bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-2 rounded-lg transition">
                            ‚Üê Naspat na hlavnu
                        </a>
                    </div>
                </div>

                <!-- –ü–µ—Ä–µ–º–∏–∫–∞—á —Ç–∞–±—ñ–≤ -->
                <div class="bg-white rounded-xl shadow-sm mb-4">
                    <div class="flex border-b">
                        {% if request.user == profile_user %}
                        <div class="profile-tab active" data-tab="posts">Moje publik√°cie</div>
                        <div class="profile-tab" data-tab="likes">P√°ƒçilo sa mi</div>
                        <div class="profile-tab" data-tab="comments">Moje koment√°re</div>
                        {% else %}
                        <div class="profile-tab active" data-tab="posts">Publik√°cie</div>
                        <div class="profile-tab" data-tab="likes">P√°ƒçilo sa</div>
                        <div class="profile-tab" data-tab="comments">Koment√°re</div>
                        {% endif %}
                    </div>

                    <!-- –¢–≤—ñ—Ç–∏ —é–∑–µ—Ä–∞ -->
                    <div id="posts" class="tab-content active p-4">
                        {% if publications %}
                        {% for post in publications %}
                        <a href="{% url 'pub' post.slug %}" class="block mb-3 hover:bg-gray-50 transition rounded-lg p-4 border bg-white">
                            <div class="flex justify-between items-start mb-2">
                                <div class="font-semibold text-gray-900">@{{ post.user.username }}</div>
                                <div class="text-sm text-gray-500">{{ post.created_at|date:"d.m.Y" }}</div>
                            </div>
                            <div class="text-gray-800 mb-2">{{ post.text }}</div>
                            <div class="flex gap-4 text-sm text-gray-600">
                                <span>üí¨ {{ post.comments.count }}</span>
                                <span>‚ù§Ô∏è {{ post.likes.count }}</span>
                            </div>
                        </a>
                        {% endfor %}
                        {% elif request.user == profile_user %}
                        <div class="empty-state">
                            <div class="text-4xl mb-2">üìù</div>
                            <div class="text-lg font-medium">E≈°te ste nevytvorili ≈æiadne pr√≠spevky.</div>
                            <div class="text-gray-500">Vytvorte si svoju prv√∫ publik√°ciu!</div>
                        </div>
                        {% else %}
                        <div class="empty-state">
                            <div class="text-4xl mb-2">üìù</div>
                            <div class="text-lg font-medium">Tento pou≈æ√≠vateƒæ e≈°te nem√° ≈æiadne pr√≠spevky.</div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- –õ–∞–π–∫–Ω—É—Ç—ñ —Ç–≤—ñ—Ç–∏ -->
                    <div id="likes" class="tab-content p-4">
                        {% if likes_publication %}
                        {% for post in likes_publication %}
                        <a href="{% url 'pub' post.publication.slug %}" class="block like-badge mb-3 hover:bg-gray-50 transition rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div class="font-semibold text-gray-900">{{ post.publication.title }}</div>
                                <div class="text-sm text-gray-500">P√°ƒçilo sa {{ post.created_at|date:"d.m.Y" }}</div>
                            </div>
                            <div class="text-gray-800 mb-2">{{ post.publication.text|truncatewords:20 }}</div>
                            <div class="text-sm text-gray-600">
                                Autor: @{{ post.publication.user.username }}
                            </div>
                        </a>
                        {% endfor %}
                        {% elif request.user == profile_user %}
                        <div class="empty-state">
                            <div class="text-4xl mb-2">‚ù§Ô∏è</div>
                            <div class="text-lg font-medium">Zatiaƒæ nemate pr√≠spevky s oznaƒçen√≠m ‚Äûp√°ƒçi sa mi to‚Äú</div>
                            <div class="text-gray-500">Dajte lajk, aby sa tu zobrazovali pr√≠spevky</div>
                        </div>
                        {% else %}
                        <div class="empty-state">
                            <div class="text-4xl mb-2">‚ù§Ô∏è</div>
                            <div class="text-lg font-medium">Zatiaƒæ ≈æiadne pr√≠spevky s oznaƒçen√≠m ‚Äûp√°ƒçi sa mi to‚Äú</div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ —é–∑–µ—Ä–∞ -->
                    <div id="comments" class="tab-content p-4">
                        {% if coments_user %}
                        {% for comment in coments_user %}
                        <a href="{% url 'pub' comment.publication.slug %}" class="block comment-badge mb-3 hover:bg-gray-50 transition rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div class="font-semibold text-gray-900">K publik√°cie: {{ comment.publication.title }}</div>
                                <div class="text-sm text-gray-500">{{ comment.created_at|date:"d.m.Y" }}</div>
                            </div>
                            <div class="text-gray-800 mb-2">{{ comment.text }}</div>
                            <div class="text-sm text-gray-600">
                                {% if comment.parent %}
                                üí¨ Odpoved na koment√°r @{{ comment.parent.user.username }}
                                {% else %}
                                üí¨ koment√°r
                                {% endif %}
                            </div>
                        </a>
                        {% endfor %}
                        {% elif request.user == profile_user %}
                        <div class="empty-state">
                            <div class="text-4xl mb-2">üí¨</div>
                            <div class="text-lg font-medium">Zatiaƒæ nemate ≈æiadne koment√°re</div>
                            <div class="text-gray-500">Zanechajte svoj prv√Ω koment√°r!</div>
                        </div>
                        {% else %}
                        <div class="empty-state">
                            <div class="text-4xl mb-2">üí¨</div>
                            <div class="text-lg font-medium">Zatiaƒæ ≈æiadne koment√°re</div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tabs = document.querySelectorAll('.profile-tab');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // –í–∏–¥–∞–ª—è—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å –∑ —É—Å—ñ—Ö –≤–∫–ª–∞–¥–æ–∫
                tabs.forEach(t => t.classList.remove('active'));
                
                // –î–æ–¥–∞—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å –¥–æ –ø–æ—Ç–æ—á–Ω–æ—ó –≤–∫–ª–∞–¥–∫–∏
                this.classList.add('active');
                
                // –•–æ–≤–∞—î–º–æ –≤—Å—ñ –≤–º—ñ—Å—Ç–∏ —Ç–∞–±—ñ–≤
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –æ–±—Ä–∞–Ω–∏–π —Ç–∞–±
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
    });
</script>
{% endblock %}