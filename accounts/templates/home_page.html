<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –ë–∞–∑–æ–≤—ñ —Å—Ç–∏–ª—ñ */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f9f9; /* –°–≤—ñ—Ç–ª–∏–π —Ñ–æ–Ω */
            color: #1a1a1a;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–∞–∫–µ—Ç—É (Flexbox –¥–ª—è 3 –∫–æ–ª–æ–Ω–æ–∫) */
        .container {
            display: flex;
            max-width: 1300px; /* –û–±–º–µ–∂–µ–Ω–Ω—è —à–∏—Ä–∏–Ω–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø—ñ–≤ */
            margin: 0 auto;
            min-height: 100vh;
        }

        /* –õ—ñ–≤–∞ –±–æ–∫–æ–≤–∞ –ø–∞–Ω–µ–ª—å (–ù–∞–≤—ñ–≥–∞—Ü—ñ—è) */
        .sidebar-left {
            width: 250px;
            padding: 20px 30px 20px 0;
            position: sticky; /* –§—ñ–∫—Å—É—î–º–æ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç—Ü—ñ */
            top: 0;
            height: fit-content;
        }

        .sidebar-left nav a {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            margin-bottom: 10px;
            text-decoration: none;
            color: #1a1a1a;
            font-size: 18px;
            font-weight: 500;
            border-radius: 9999px; /* –û–∫—Ä—É–≥–ª–µ–Ω—ñ –∫–Ω–æ–ø–∫–∏ */
            transition: background-color 0.2s;
        }

        .sidebar-left nav a:hover {
            background-color: #e6e6e6;
        }
        
        .sidebar-left nav a span {
            margin-left: 15px;
        }

        /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ (–°—Ç—Ä—ñ—á–∫–∞) */
        .main-content {
            flex-grow: 1;
            max-width: 600px; /* –¢–∏–ø–æ–≤–∞ —à–∏—Ä–∏–Ω–∞ —Å—Ç—Ä—ñ—á–∫–∏ */
            border-left: 1px solid #ebeef0;
            border-right: 1px solid #ebeef0;
        }

        .feed-header {
            padding: 15px;
            font-size: 20px;
            font-weight: bold;
            border-bottom: 1px solid #ebeef0;
            background-color: #ffffff;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .new-post-form {
            padding: 15px;
            border-bottom: 10px solid #ebeef0;
        }
        
        .post-textarea {
            width: 100%;
            border: none;
            outline: none;
            font-size: 19px;
            resize: none;
            min-height: 50px;
            padding: 15px 0;
            box-sizing: border-box;
        }
        
        .post-button {
            background-color: #1da1f2;
            color: white;
            border: none;
            padding: 8px 18px;
            border-radius: 9999px;
            font-weight: bold;
            cursor: pointer;
            float: right;
            transition: background-color 0.2s;
        }
        .post-button:hover {
            background-color: #0c85d0;
        }

        /* –°—Ç–∏–ª—å –æ–∫—Ä–µ–º–æ–≥–æ –ø–æ—Å—Ç–∞ */
        .publication-wrapper {
            padding: 15px;
            border-bottom: 1px solid #ebeef0;
            cursor: pointer;
            transition: background-color 0.1s;
        }
        .publication-wrapper:hover {
            background-color: #f7f7f7;
        }

        .post-author {
            font-weight: bold;
        }

        .post-handle {
            color: #5b7083;
            margin-left: 5px;
            font-size: 15px;
        }
        .post-stats {
            color: #5b7083; 
            font-size: 14px; 
            margin-top: 10px;
        }

        /* --- –ù–û–í–Ü –°–¢–ò–õ–Ü –î–õ–Ø –ö–û–ú–ï–ù–¢–ê–†–Ü–í --- */
        
        .comment-section-wrapper {
            /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—ñ–∑—É–∞–ª—å–Ω–æ–≥–æ –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ */
            padding-top: 5px;
            padding-left: 20px; /* –ù–µ–≤–µ–ª–∏–∫–∏–π –≤—ñ–¥—Å—Ç—É–ø –¥–ª—è –≤–∫–ª–∞–¥–µ–Ω–æ—Å—Ç—ñ */
        }
        
        .comment-item {
            /* –°—Ç–∏–ª—å –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –æ–∫—Ä–µ–º–æ–≥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è */
            padding: 10px 15px;
            margin-top: 5px;
            margin-bottom: 5px;
            border-left: 3px solid #e0e0e0; /* –í—ñ–∑—É–∞–ª—å–Ω–∞ –ª—ñ–Ω—ñ—è –≤–∫–ª–∞–¥–µ–Ω–æ—Å—Ç—ñ */
            background-color: #fafafa; /* –°–≤—ñ—Ç–ª—ñ—à–∏–π —Ñ–æ–Ω */
            border-radius: 8px;
            font-size: 15px; /* –ú–µ–Ω—à–∏–π —à—Ä–∏—Ñ—Ç, –Ω—ñ–∂ —É –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó */
            transition: background-color 0.1s;
        }

        .comment-item:hover {
            background-color: #f2f2f2;
        }

        .comment-text {
            margin-top: 3px;
            line-height: 1.3;
        }

        .comment-author {
            font-weight: 600;
            font-size: 14px;
        }
        /* --- –ö–Ü–ù–ï–¶–¨ –ù–û–í–ò–• –°–¢–ò–õ–Ü–í --- */

        /* –ü—Ä–∞–≤–∞ –±–æ–∫–æ–≤–∞ –ø–∞–Ω–µ–ª—å (–¢—Ä–µ–Ω–¥–∏) */
        .sidebar-right {
            width: 350px;
            padding: 20px 0 20px 30px;
            position: sticky;
            top: 0;
            height: fit-content;
        }

        .trends-block {
            background-color: #eff3f4;
            border-radius: 16px;
            padding: 10px 0;
            margin-bottom: 15px;
        }

        .trends-block h3 {
            font-size: 19px;
            padding: 0 15px 10px;
            margin: 0;
        }

        .trend-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.1s;
        }
        
        .trend-item:hover {
            background-color: #e6e6e6;
        }

        .trend-category {
            font-size: 13px;
            color: #5b7083;
        }

        .trend-name {
            font-weight: bold;
            font-size: 15px;
            color: #1a1a1a;
        }
        
        /* –ü—Ä–æ—Å—Ç–∏–π —Å—Ç–∏–ª—å –¥–ª—è —ñ–∫–æ–Ω–æ–∫ (–∑–∞–º—ñ—Å—Ç—å Font Awesome –∞–±–æ SVG) */
        .icon {
            font-size: 24px;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è –≤—É–∑—å–∫–∏—Ö –µ–∫—Ä–∞–Ω—ñ–≤ */
        @media (max-width: 1000px) {
            .sidebar-right {
                display: none; /* –•–æ–≤–∞—î–º–æ –ø—Ä–∞–≤—É –ø–∞–Ω–µ–ª—å –Ω–∞ –≤—É–∑—å–∫–∏—Ö –µ–∫—Ä–∞–Ω–∞—Ö */
            }
            .sidebar-left {
                width: 80px; /* –ó–º–µ–Ω—à—É—î–º–æ —à–∏—Ä–∏–Ω—É –ª—ñ–≤–æ—ó –ø–∞–Ω–µ–ª—ñ */
                padding-right: 10px;
            }
            .sidebar-left nav a span {
                display: none; /* –•–æ–≤–∞—î–º–æ —Ç–µ–∫—Å—Ç, –ª–∏—à–∞—î–º–æ –ª–∏—à–µ —ñ–∫–æ–Ω–∫–∏ */
            }
            .sidebar-left .post-button {
                 width: 50px !important;
                 height: 50px;
                 padding: 0;
                 font-size: 0;
                 border-radius: 50%;
                 display: flex;
                 justify-content: center;
                 align-items: center;
            }
            .sidebar-left .post-button::after {
                content: "‚úçÔ∏è"; /* –Ü–∫–æ–Ω–∫–∞ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–æ—ó –∫–Ω–æ–ø–∫–∏ */
                font-size: 20px;
                line-height: 1;
            }
        }
    </style>
</head>
<body>

    <div class="container">

        <div class="sidebar-left">
            <nav>
                <a href="#"><span class="icon">üè†</span><span>Domov</span></a>
                <a href="#"><span class="icon">#</span><span>Prehlad</span></a>
                <a href="#"><span class="icon">üîî</span><span>Upozornenia</span></a>
                <a href="#"><span class="icon">‚úâÔ∏è</span><span>Spravy</span></a>
                <a href="#"><span class="icon">üë§</span><span>Profil</span></a>
                <a href="#"><span class="icon">‚öôÔ∏è</span><span>Viac</span></a>
            </nav>
            <button class="post-button" style="width: 100%; margin-top: 20px;">Publikova≈•</button>
        </div>

        <div class="main-content">
            <div class="feed-header">Domov</div>

            
        <div class="new-post-form">
            <form method="POST" action="{% url 'create_publication' %}">
                {% csrf_token %}
                <input type="text" style = "padding = 5px; margin = 5px;" name="title" placeholder="N√°zov" class="post-textarea" style="font-weight: bold;"><br>
                <textarea name="text" class="post-textarea" placeholder="Co sa deje?"></textarea><br>
                <input type="text" name="tags" class="post-textarea" placeholder="Tagy (oddeli medzerou alebo cez ,)"><br>
                <button type="submit" class="post-button">Publikovat</button>
            </form>
            <div style="clear: both;"></div>
        </div>


            {%for pub in publication%}
            <div class="publication-wrapper">

<div>
    <div class="post-author"> {{pub.title}} <span class="post-handle">@{{pub.user.username}}</span></div>

    <div class="post-text">
        <a href="{% url 'pub' pub.slug %}" style="text-decoration:none; color:inherit; cursor:pointer;">
            {{ pub.text }}
        </a>
    </div>
    <div class="post-tags">
        {% for tag in pub.tags.all %}
            <span class="tag">#{{ tag }}</span>
        {% endfor %}
    </div>

    <div class="post-stats">

        <a href="{% url 'create_comments' pub.slug %}" style="text-decoration:none; color:inherit; cursor:pointer;">
            üí¨ {{ pub.comments.count }}
        </a>
        &nbsp;&nbsp;

        <span class="like-button" data-slug="{{ pub.slug }}" style="cursor:pointer;">
            ‚ù§Ô∏è <span class="like-count">{{ pub.likes.count }}</span>
        </span>
    </div>
</div>

                {%for comment in pub.comments.all|slice:":3"%}
                {% if comment.parent %}
                    
                {% else %}
                <div class="comment-section-wrapper">
                    <div class="comment-item">
                        <div class="comment-author"> {{comment.user}} <span class="post-handle">@{{comment.user}}</span></div>
                        <div class="comment-text">{{comment.text}}</div>
                    </div>
                </div>
                 {%endif%}
                {%endfor%}
            </div>
            {%endfor%}

        </div>
        

        <div class="sidebar-right">
            <div class="trends-block">
                <h3>Trendy pre v√°s</h3>
                
                <div class="trend-item">
                    <div class="trend-category">–¢–µ–Ω–¥–µ–Ω—Ü—ñ—ó –≤ –£–∫—Ä–∞—ó–Ω—ñ</div>
                    <div class="trend-name">#–†–æ–∑—Ä–æ–±–∫–∞–ú–∞–∫–µ—Ç—É</div>
                    <div class="trend-category">1.5K —Ç–≤—ñ—Ç—ñ–≤</div>
                </div>

                <div class="trend-item">
                    <div class="trend-category">–°–ø–æ—Ä—Ç</div>
                    <div class="trend-name">–ó–∏–º–æ–≤—ñ –Ü–≥—Ä–∏</div>
                    <div class="trend-category">50K —Ç–≤—ñ—Ç—ñ–≤</div>
                </div>
                
                <div class="trend-item">
                    <div class="trend-category">–ü–æ–ª—ñ—Ç–∏–∫–∞</div>
                    <div class="trend-name">–ù–æ–≤—ñ –ó–∞–∫–æ–Ω–∏</div>
                    <div class="trend-category">89K —Ç–≤—ñ—Ç—ñ–≤</div>
                </div>
            </div>
        </div>

    </div>


<script>
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('.like-button').forEach(btn => {
        btn.addEventListener('click', async () => {
            console.log("click!");  // ‚úÖ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
            const slug = btn.dataset.slug;
            const response = await fetch(`/like/${slug}/`, {
                method: "POST",
                headers: {
                    "X-CSRFToken": "{{ csrf_token }}",
                    "X-Requested-With": "XMLHttpRequest"
                }
            });
            const data = await response.json();
            btn.querySelector('.like-count').textContent = data.likes;
        });
    });
});
</script>

</body>
</html>
