
    <div class="publication-wrapper">

        <div class="post-content">
            <div class="post-header">
                <div class="post-author">
                    {{ pub.title }} <span class="post-handle">@{{ pub.user.username }}</span>
                </div>
            </div>
            <div class="post-text">{{ pub.text }}.</div>
            
            <div class="post-stats">

                <a href="{% url 'create_comments' pub.slug %}" class="stat-link comment-link">
                    üí¨ {{ pub.comments.count }}
                </a>
                &nbsp;&nbsp;

                <span class="like-button stat-link" data-slug="{{ pub.slug }}">
                    ‚ù§Ô∏è <span class="like-count">{{ pub.likes.count }}</span>
                </span>
            </div>
        </div>
      {% if pub.comments.all %}
{% for comment in pub.comments.all %}
    <div style="margin-left: {% if comment.parent %}40px{% else %}0{% endif %};">
        <b>{{ comment.user }}</b>: {{ comment.text }}
        <small>{{ comment.created_at }}</small>

        <a href="{% url 'create_reply' pub.slug comment.id %}">–í—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏</a>
    </div>
{% endfor %}
{% endif %}

<style>

    
    /* ------------------------------------------------------------------- */
    /* –ö–û–ú–ï–ù–¢–ê–†–Ü –¢–ê –í–Ü–î–ü–û–í–Ü–î–Ü (–ì–û–õ–û–í–ù–ê –ó–ú–Ü–ù–ê) */
    /* (–ó–∞–ª–∏—à—Ç–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è .comment-section-wrapper) */
    /* ------------------------------------------------------------------- */

    /* –û–±–≥–æ—Ä—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è (—è–∫ –±—É–ª–æ —Ä–∞–Ω—ñ—à–µ, –∑ –≤—ñ–¥—Å—Ç—É–ø–æ–º 25px) */
    .comment-section-wrapper {
        padding: 10px;
        margin-bottom: 8px;
        background-color: #F7F9FA;
        border-radius: 8px;
        border: 1px solid #E1E8ED;
        margin-left: 25px; 
    }

    /* –û–±–≥–æ—Ä—Ç–∫–∞ –≤—Å—ñ—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –Ω–∞ –æ–¥–∏–Ω –∫–æ–º–µ–Ω—Ç–∞—Ä */
    .replies-wrapper {
        /* –î–æ–¥–∞—î–º–æ –Ω–µ–≤–µ–ª–∏–∫–∏–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä */
            margin-top: 5px; 
    }

    /* –°—Ç–∏–ª—å –¥–ª—è —Å–∞–º–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–≤–∫–ª–∞–¥–µ–Ω–æ–≥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è) */
    .reply-item {
        padding: 8px;
        margin-bottom: 5px;
       background-color: #EFF4F7; /* –©–µ —Å–≤—ñ—Ç–ª—ñ—à–∏–π —Ñ–æ–Ω, –Ω—ñ–∂ —É –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è */
       border-radius: 6px;
       border-left: 3px solid #1DA1F2; /* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–∏–Ω—é —Å–º—É–∂–∫—É –¥–ª—è –∞–∫—Ü–µ–Ω—Ç—É */
       font-size: 0.85em; /* –¢—Ä–æ—Ö–∏ –º–µ–Ω—à–∏–π —à—Ä–∏—Ñ—Ç */

       /* –ó–ú–Ü–©–ï–ù–ù–Ø –í–ü–†–ê–í–û - –û–°–ù–û–í–ù–ê –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø (–¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –≤—ñ–¥—Å—Ç—É–ø) */
        margin-left: 25px; /* –ó–∞–≥–∞–ª—å–Ω–∏–π –≤—ñ–¥—Å—Ç—É–ø –≤—ñ–¥ –ø–æ—á–∞—Ç–∫—É –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó –±—É–¥–µ 50px */
    }

    /* ------------------------------------------------------------------- */
    /* –ê–í–¢–û–† –í–Ü–î–ü–û–í–Ü–î–Ü */
    /* ------------------------------------------------------------------- */
    .reply-author {
        font-weight: 600;
        color: #14171A;
        margin-bottom: 3px;
    }

    /* –°—Ç–∏–ª—å –¥–ª—è –≤–∏–¥—ñ–ª–µ–Ω–Ω—è, –∫–æ–º—É —Å–∞–º–µ –±—É–ª–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å */
    .reply-author .post-handle {
        font-weight: normal;
        color: #657786;
        font-size: 0.9em;
    }

    .reply-text {
        line-height: 1.4;
        color: #14171A;
    }


    /* ------------------------------------------------------------------- */
    /* –û–°–ù–û–í–ù–ê –°–¢–†–£–ö–¢–£–†–ê –ü–£–ë–õ–Ü–ö–ê–¶–Ü–á */
    /* ------------------------------------------------------------------- */
    .publication-wrapper {
        border: 1px solid #E1E8ED; /* –°–≤—ñ—Ç–ª–æ-—Å—ñ—Ä–∏–π –±–æ—Ä–¥—é—Ä, —è–∫ —É —Å–æ—Ü–º–µ—Ä–µ–∂–∞—Ö */
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 20px;
        background-color: #FFFFFF;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); /* –õ–µ–≥–∫–∞ —Ç—ñ–Ω—å */
        transition: box-shadow 0.3s ease;
    }
    .publication-wrapper:hover {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* –¢—ñ–Ω—å –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
    }

    /* ------------------------------------------------------------------- */
    /* –ó–ê–ì–û–õ–û–í–ö–ò –¢–ê –¢–ï–ö–°–¢ */
    /* ------------------------------------------------------------------- */
    .post-author {
        font-weight: 700; /* –ñ–∏—Ä–Ω—ñ—à–µ */
        color: #14171A; /* –¢–µ–º–Ω–∏–π —Ç–µ–∫—Å—Ç */
        font-size: 1.1em;
        margin-bottom: 2px;
    }
    .post-handle {
        font-weight: 400;
        color: #657786; /* –°—ñ—Ä–∏–π –∫–æ–ª—ñ—Ä, —Ç–∏–ø–æ–≤–∏–π –¥–ª—è —Ö–µ–Ω–¥–ª—ñ–≤ */
        font-size: 0.9em;
        margin-left: 5px;
    }
    .post-text {
        margin: 10px 0 15px 0;
        line-height: 1.5;
        color: #14171A;
    }

    /* ------------------------------------------------------------------- */
    /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê (–õ–ê–ô–ö–ò, –ö–û–ú–ï–ù–¢–ê–†–Ü) */
    /* ------------------------------------------------------------------- */
    .post-stats {
        display: flex;
        gap: 25px;
        margin-top: 10px;
        padding-top: 5px;
        border-top: 1px solid #E1E8ED;
    }
    .stat-link {
        display: flex; /* –î–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è —ñ–∫–æ–Ω–∫–∏ —Ç–∞ —Ç–µ–∫—Å—Ç—É */
        align-items: center;
        text-decoration: none;
        color: #657786;
        cursor: pointer;
        font-size: 0.9em;
        transition: color 0.2s;
    }
    .stat-link:hover {
        color: #1DA1F2; /* –°–∏–Ω—ñ–π –¥–ª—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—É */
    }
    .like-button:hover {
        color: #E0245E; /* –ß–µ—Ä–≤–æ–Ω–∏–π –¥–ª—è –ª–∞–π–∫—ñ–≤ */
    }

    /* ------------------------------------------------------------------- */
    /* –ö–û–ú–ï–ù–¢–ê–†–Ü –¢–ê –í–Ü–î–ü–û–í–Ü–î–Ü (–ì–û–õ–û–í–ù–ê –ó–ú–Ü–ù–ê) */
    /* ------------------------------------------------------------------- */

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ */
    .comments-container {
        margin-top: 15px;
        padding-top: 10px;
        /* –õ–µ–≥–∫–∞ –º–µ–∂–∞, —â–æ –≤—ñ–¥–æ–∫—Ä–µ–º–ª—é—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –≤—ñ–¥ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É */
        border-top: 1px dashed #E1E8ED;
    }
    
    /* –û–±–≥–æ—Ä—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è */
    .comment-section-wrapper {
        padding: 10px;
        margin-bottom: 8px;
        background-color: #F7F9FA; /* –î—É–∂–µ —Å–≤—ñ—Ç–ª–∏–π —Ñ–æ–Ω –¥–ª—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ */
        border-radius: 8px;
        border: 1px solid #E1E8ED;
        
        /* –ó–ú–Ü–©–ï–ù–ù–Ø –í–ü–†–ê–í–û - –û–°–ù–û–í–ù–ê –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø */
        margin-left: 25px; 
        /* –ö—ñ–Ω–µ—Ü—å –ó–ú–Ü–©–ï–ù–ù–Ø */
    }

    .comment-item {
        font-size: 0.9em;
    }
    .comment-author {
        font-weight: 600;
        color: #1DA1F2; /* –°–∏–Ω—ñ–π –¥–ª—è –∞–≤—Ç–æ—Ä—ñ–≤ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ */
    }
    .comment-text {
        margin-top: 5px;
        color: #14171A;
    }
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('.like-button').forEach(btn => {
        btn.addEventListener('click', async () => {
            console.log("click!");  // ‚úÖ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
            const slug = btn.dataset.slug;
            const response = await fetch(`/like/${slug}/`, {
                method: "POST",
                headers: {
                    "X-CSRFToken": "{{ csrf_token }}",
                    "X-Requested-With": "XMLHttpRequest"
                }
            });
            const data = await response.json();
            btn.querySelector('.like-count').textContent = data.likes;
        });
    });
});
</script>